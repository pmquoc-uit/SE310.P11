import{A as qe,B as Be,C as $e,D as Ge,E as He,F as We,G as re,H as Qe,I as Je,J as Ke,b as Se,c as U,e as T,f as D,g as B,h as X,i as Te,j as De,k as Me,m as ke,n as Ie,o as oe,p as Ae,q as z,r as Ne,s as Fe,t as Re,u as Ve,v as Le,w as Oe,x as je,y as Ue,z as ze}from"./chunk-CNUDHH44.js";import{a as Ce,c as Z}from"./chunk-TC32T2HF.js";import{a as Xe}from"./chunk-ZQ6FQOV3.js";import{a as Y}from"./chunk-QDWNCEW7.js";import{B as ve,D as _,F as V,G as L,H as ye,I as we,J as O,M as W,N as Q,P as J,Q as j,R as K,T as Ee,X as Pe,z as R}from"./chunk-MR5DOF4S.js";import"./chunk-6XXA7HXI.js";import{ea as xe,ja as P,k as be}from"./chunk-3SLA3PJL.js";import{Aa as S,Eb as F,Fb as k,Hb as I,Ib as A,Jb as o,Kb as r,Lb as f,Mb as g,Nb as b,Pb as q,Rc as G,Sb as c,Tc as he,Ub as h,Uc as ge,Vc as H,Yb as ie,bb as N,bc as de,cc as m,dc as x,eb as l,ec as v,f as ae,fb as w,ga as me,gc as se,hc as pe,ic as ce,kc as E,lc as ue,ma as u,oc as $,pc as ne,qa as y,qc as fe,xb as p,y as le,za as C,zb as d,zc as _e}from"./chunk-EF2V77MD.js";var Ye=(()=>{class e{constructor(){this.dialogRef=u(T),this.data=u(D)}onConfirm(){this.dialogRef.close(!0)}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=y({type:e,selectors:[["app-confirmation-dialog"]],standalone:!0,features:[E],decls:12,vars:2,consts:[[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-50"],[1,"max-w-lg","w-full","mx-auto","bg-white","p-8","rounded-md","shadow-lg"],[1,"p-4"],[1,"text-lg","font-semibold","mb-4"],[1,"mb-4"],[1,"flex","justify-end","gap-2"],["mat-stroked-button","","color","warn",3,"click"],["mat-stroked-button","",3,"click"]],template:function(n,i){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),m(4),r(),o(5,"p",4),m(6),r(),o(7,"div",5)(8,"button",6),c("click",function(){return i.onCancel()}),m(9," Cancel "),r(),o(10,"button",7),c("click",function(){return i.onConfirm()}),m(11,"Confirm"),r()()()()()),n&2&&(l(4),x(i.data.title),l(2),x(i.data.message))},dependencies:[P]})}}return e})();var Ze=(()=>{class e{constructor(){this.dialog=u(B)}confirm(t,n){let i=this.dialog.open(Ye,{width:"400px",data:{title:t,message:n}});return le(i.afterClosed())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var te=class{constructor(){this.pageNumber=1,this.pageSize=10,this.filter=""}};function rt(e,a){e&1&&(o(0,"div",21),f(1,"mat-progress-spinner",22),o(2,"span",23),m(3,"Uploading..."),r()()),e&2&&(l(),d("diameter",50))}function at(e,a){e&1&&f(0,"app-text-input",24)}function lt(e,a){if(e&1&&f(0,"app-text-input",25),e&2){let t=h();d("disabled",!t.isEditing)}}function mt(e,a){if(e&1&&f(0,"img",26),e&2){let t=h();d("src",t.imagePreview,N)}}function dt(e,a){if(e&1&&(o(0,"li"),m(1),r()),e&2){let t=a.$implicit;l(),x(t)}}function st(e,a){if(e&1&&(o(0,"div",19)(1,"ul",27),I(2,dt,2,1,"li",null,k),r()()),e&2){let t=h();l(2),A(t.validationErrors)}}var it=(()=>{class e{constructor(t,n){this.dialogRef=t,this.data=n,this.shopService=u(U),this.fb=u(J),this.snack=u(R),this.imagePreview="https://placehold.co/800.png",this.isLoading=!1,this.nonEditing=!0,this.isEditing=!1;let i=n.product;this.imagePreview=i.pictureUrl,this.editForm=this.fb.group({id:[i.id,_.required],name:[{value:i.name,disabled:!0},_.required],description:[{value:i.description,disabled:!0},_.required],price:[{value:i.price,disabled:!0},[_.required,_.min(.01)]],quantityInStock:[{value:i.quantityInStock,disabled:!0},[_.required,_.min(0)]],type:[{value:i.type,disabled:!0},_.required],brand:[{value:i.brand,disabled:!0},_.required],pictureUrl:[{value:i.pictureUrl,disabled:!0},_.required]})}ensureMinValue(t,n){let i=this.editForm.get(t);i&&i.value!==null&&i.value<n&&i.setValue(n,{emitEvent:!1})}toggleEdit(){if(this.isEditing){let t=this.editForm.value,n=this.data.product.id;this.isLoading=!0,this.shopService.updateProduct(n,t).subscribe({next:i=>{console.log("Update successful:",i),this.snack.success("Update successful"),this.isEditing=!1,this.editForm.disable(),this.dialogRef.close(t),this.isLoading=!1},error:i=>{console.error("Update failed:",i),this.snack.error("Update failed"),this.isLoading=!1}})}else this.isEditing=!0,this.editForm.enable()}onFileSelected(t){let n=t.target.files?.[0];if(n){let i=new FormData;i.append("file",n),i.append("upload_preset","your_preset"),this.isLoading=!0,this.shopService.uploadPhoto(i).subscribe({next:s=>{this.isLoading=!1,this.editForm.patchValue({pictureUrl:s.secureUrl}),this.imagePreview=s.secureUrl,this.snack.success("Photo upload successful")},error:s=>{this.isLoading=!1,console.error("Photo upload failed:",s),this.snack.error("Photo upload failed")}})}}static{this.\u0275fac=function(n){return new(n||e)(w(T),w(D))}}static{this.\u0275cmp=y({type:e,selectors:[["app-product-edit"]],standalone:!0,features:[E],decls:24,vars:15,consts:[[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-50"],[1,"max-w-lg","w-full","mx-auto","bg-white","p-8","rounded-md","shadow-lg","h-[95vh]","overflow-y-auto","scrollbar-custom"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-10",4,"ngIf"],[3,"formGroup"],[1,"text-center","mb-6"],[1,"text-3xl","font-semibold","text-primary"],["label","Id","formControlName","id","type","number",4,"ngIf"],["label","Name","formControlName","name","type","text",3,"disabled"],["label","Description","formControlName","description","type","text",3,"disabled"],["label","Price","formControlName","price","type","number",3,"input","disabled"],["label","Quantity in Stock","formControlName","quantityInStock","type","number",3,"input","disabled"],["label","Type","formControlName","type","type","text",3,"disabled"],["label","Brand","formControlName","brand","type","text",3,"disabled"],["label","PicUrl","formControlName","pictureUrl","type","text",3,"disabled",4,"ngIf"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700","text-center"],[1,"mt-2","flex","flex-col","items-center","gap-4"],["alt","Selected Image","class","h-32 w-32 object-cover rounded-md border border-gray-300",3,"src",4,"ngIf"],["type","file","accept","image/*",1,"block","w-auto","text-sm","text-slate-950","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-primary","file:text-indigo-700","hover:file:bg-primary-dark",3,"change","disabled"],[1,"mb-3","p-4","bg-red-100","text-red-600"],["mat-flat-button","","type","button",1,"w-full","py-2","bg-primary","text-white","rounded-md","shadow","hover:bg-primary-dark","transition",3,"click"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-80","z-10"],["mode","indeterminate","color","primary",3,"diameter"],[1,"ml-4","text-lg","text-gray-700"],["label","Id","formControlName","id","type","number"],["label","PicUrl","formControlName","pictureUrl","type","text",3,"disabled"],["alt","Selected Image",1,"h-32","w-32","object-cover","rounded-md","border","border-gray-300",3,"src"],[1,"list-disc","px-3"]],template:function(n,i){if(n&1&&(o(0,"div",0)(1,"div",1),p(2,rt,4,1,"div",2),o(3,"form",3)(4,"div",4)(5,"h1",5),m(6),r()(),p(7,at,1,0,"app-text-input",6),f(8,"app-text-input",7)(9,"app-text-input",8),o(10,"app-text-input",9),c("input",function(){return i.ensureMinValue("price",.01)}),r(),o(11,"app-text-input",10),c("input",function(){return i.ensureMinValue("quantityInStock",1)}),r(),f(12,"app-text-input",11)(13,"app-text-input",12),p(14,lt,1,1,"app-text-input",13),o(15,"div",14)(16,"label",15),m(17,"Picture"),r(),o(18,"div",16),p(19,mt,1,1,"img",17),o(20,"input",18),c("change",function(M){return i.onFileSelected(M)}),r()()(),p(21,st,4,0,"div",19),o(22,"button",20),c("click",function(){return i.toggleEdit()}),m(23),r()()()()),n&2){let s;l(2),d("ngIf",i.isLoading),l(),d("formGroup",i.editForm),l(3),v(" Edit Product No. ",(s=i.editForm.get("id"))==null?null:s.value," "),l(),d("ngIf",!1),l(),d("disabled",!i.isEditing),l(),d("disabled",!i.isEditing),l(),d("disabled",!i.isEditing),l(),d("disabled",!i.isEditing),l(),d("disabled",!i.isEditing),l(),d("disabled",!i.isEditing),l(),d("ngIf",!1),l(5),d("ngIf",i.imagePreview),l(),d("disabled",!i.isEditing),l(),F(i.validationErrors?21:-1),l(2),v(" ",i.isEditing?"Save Changes":"Edit"," ")}},dependencies:[z,P,j,O,V,L,K,W,Q,H,G,Y,X,Z],styles:['@charset "UTF-8";.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#838b8b;border-radius:8px}.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#edf2f7;border-radius:8px}']})}}return e})();function pt(e,a){e&1&&(o(0,"div",21),f(1,"mat-progress-spinner",22),o(2,"span",23),m(3,"Uploading..."),r()()),e&2&&(l(),d("diameter",50))}function ct(e,a){e&1&&f(0,"app-text-input",24)}function ut(e,a){e&1&&f(0,"app-text-input",25)}function ft(e,a){if(e&1&&f(0,"img",26),e&2){let t=h();d("src",t.imagePreview,N)}}function _t(e,a){if(e&1&&(o(0,"li"),m(1),r()),e&2){let t=a.$implicit;l(),x(t)}}function ht(e,a){if(e&1&&(o(0,"div",19)(1,"ul",27),I(2,_t,2,1,"li",null,k),r()()),e&2){let t=h();l(2),A(t.validationErrors)}}var nt=(()=>{class e{constructor(t,n){this.dialogRef=t,this.data=n,this.shopService=u(U),this.fb=u(J),this.snack=u(R),this.imagePreview="https://placehold.co/800.png",this.isLoading=!1,this.newForm=this.fb.group({id:[0],name:["",_.required],description:["",_.required],price:["",[_.required,_.min(.01)]],quantityInStock:["",[_.required,_.min(0)]],type:["",_.required],brand:["",_.required],pictureUrl:["",_.required]})}ensureMinValue(t,n){let i=this.newForm.get(t);i&&i.value!==null&&i.value<n&&i.setValue(n,{emitEvent:!1})}onSubmit(){let t=this.newForm.value;console.log(t),this.isLoading=!0,this.shopService.newProduct(t).subscribe({next:n=>{try{let i=JSON.parse(n);i&&i.id&&(console.log("Product created successfully:",i),this.snack.success("Product created successfully!"),this.dialogRef.close(!0),this.isLoading=!1)}catch{console.log("Text response:",n),this.snack.error(n),this.isLoading=!1}},error:n=>{console.error("Error creating product:",n),this.snack.error("Added failed!")}})}onFileSelected(t){let n=t.target.files?.[0];if(n){let i=new FormData;i.append("file",n),i.append("upload_preset","your_preset"),this.isLoading=!0,this.shopService.uploadPhoto(i).subscribe({next:s=>{this.isLoading=!1,this.newForm.patchValue({pictureUrl:s.secureUrl}),this.imagePreview=s.secureUrl,this.snack.success("Photo upload successful")},error:s=>{this.isLoading=!1,console.error("Photo upload failed:",s),this.snack.error("Photo upload failed")}})}}static{this.\u0275fac=function(n){return new(n||e)(w(T),w(D))}}static{this.\u0275cmp=y({type:e,selectors:[["app-product-new"]],standalone:!0,features:[E],decls:24,vars:7,consts:[[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-50"],[1,"max-w-lg","w-full","mx-auto","bg-white","p-8","rounded-md","shadow-lg","h-[95vh]","overflow-y-auto","scrollbar-custom"],[3,"ngSubmit","formGroup"],[1,"text-center","mb-6"],[1,"text-3xl","font-semibold","text-primary"],["class","absolute inset-0 flex items-center justify-center bg-white bg-opacity-80 z-10",4,"ngIf"],["label","Id","formControlName","id","type","number",4,"ngIf"],["label","Name","formControlName","name","type","text"],["label","Description","formControlName","description","type","text"],["label","Price","formControlName","price","type","number",3,"input"],["label","Quantity in Stock","formControlName","quantityInStock","type","number",3,"input"],["label","Type","formControlName","type","type","text"],["label","Brand","formControlName","brand","type","text"],["label","PicUrl","formControlName","pictureUrl","type","text",4,"ngIf"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700","text-center"],[1,"mt-2","flex","flex-col","items-center","gap-4"],["alt","Selected Image","class","h-32 w-32 object-cover rounded-md border border-gray-300",3,"src",4,"ngIf"],["type","file","accept","image/*",1,"block","w-auto","text-sm","text-slate-950","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-primary","file:text-indigo-700","hover:file:bg-primary-dark",3,"change"],[1,"mb-3","p-4","bg-red-100","text-red-600"],["mat-flat-button","","type","submit",1,"w-full","py-2","bg-primary","text-white","rounded-md","shadow","hover:bg-primary-dark","transition",3,"disabled"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-white","bg-opacity-80","z-10"],["mode","indeterminate","color","primary",3,"diameter"],[1,"ml-4","text-lg","text-gray-700"],["label","Id","formControlName","id","type","number"],["label","PicUrl","formControlName","pictureUrl","type","text"],["alt","Selected Image",1,"h-32","w-32","object-cover","rounded-md","border","border-gray-300",3,"src"],[1,"list-disc","px-3"]],template:function(n,i){n&1&&(o(0,"div",0)(1,"div",1)(2,"form",2),c("ngSubmit",function(){return i.onSubmit()}),o(3,"div",3)(4,"h1",4),m(5,"New Product"),r()(),p(6,pt,4,1,"div",5)(7,ct,1,0,"app-text-input",6),f(8,"app-text-input",7)(9,"app-text-input",8),o(10,"app-text-input",9),c("input",function(){return i.ensureMinValue("price",.01)}),r(),o(11,"app-text-input",10),c("input",function(){return i.ensureMinValue("quantityInStock",1)}),r(),f(12,"app-text-input",11)(13,"app-text-input",12),p(14,ut,1,0,"app-text-input",13),o(15,"div",14)(16,"label",15),m(17,"Picture"),r(),o(18,"div",16),p(19,ft,1,1,"img",17),o(20,"input",18),c("change",function(M){return i.onFileSelected(M)}),r()()(),p(21,ht,4,0,"div",19),o(22,"button",20),m(23," Save new Product "),r()()()()),n&2&&(l(2),d("formGroup",i.newForm),l(4),d("ngIf",i.isLoading),l(),d("ngIf",!1),l(7),d("ngIf",!1),l(5),d("ngIf",i.imagePreview),l(2),F(i.validationErrors?21:-1),l(),d("disabled",i.newForm.invalid))},dependencies:[z,P,j,O,V,L,K,W,Q,H,G,Y,X,Z],styles:['@charset "UTF-8";.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#838b8b;border-radius:8px}.scrollbar-custom[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#edf2f7;border-radius:8px}']})}}return e})();var gt=()=>[5,10,20];function bt(e,a){if(e&1&&(o(0,"mat-option",9),m(1),r()),e&2){let t=a.$implicit;d("value",t),l(),x(t)}}function xt(e,a){e&1&&(o(0,"th",34),m(1,"No."),r())}function Ct(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.id)}}function St(e,a){e&1&&(o(0,"th",34),m(1,"Buyer email"),r())}function vt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.buyerEmail)}}function yt(e,a){e&1&&(o(0,"th",34),m(1,"Date"),r())}function wt(e,a){if(e&1&&(o(0,"td",35),m(1),$(2,"date"),r()),e&2){let t=a.$implicit;l(),v(" ",fe(2,1,t.orderDate,"short")," ")}}function Et(e,a){e&1&&(o(0,"th",34),m(1,"Total"),r())}function Pt(e,a){if(e&1&&(o(0,"td",35),m(1),$(2,"currency"),r()),e&2){let t=a.$implicit;l(),v(" ",ne(2,1,t.total)," ")}}function Tt(e,a){e&1&&(o(0,"th",34),m(1,"Status"),r())}function Dt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.status)}}function Mt(e,a){e&1&&(o(0,"th",34),m(1,"Actions"),r())}function kt(e,a){if(e&1){let t=q();o(0,"td",35)(1,"div",36)(2,"button",37)(3,"mat-icon",38),m(4,"visibility"),r()(),o(5,"button",39),c("click",function(){let i=C(t).$implicit,s=h();return S(s.openConfirmDialog(i.id))}),o(6,"mat-icon",40),m(7,"undo"),r()()()()}if(e&2){let t=a.$implicit;l(2),ie("routerLink","/orders/",t.id,""),l(3),d("disabled",t.status==="Refunded")}}function It(e,a){e&1&&f(0,"tr",41)}function At(e,a){e&1&&f(0,"tr",42)}function Nt(e,a){if(e&1&&(o(0,"mat-list-option",54),m(1),r()),e&2){let t=a.$implicit,n=h(2);d("value",t.value)("selected",n.shopParams.sort===t.value),l(),v(" ",t.name," ")}}function Ft(e,a){if(e&1){let t=q();o(0,"div",43)(1,"div",44)(2,"mat-paginator",45),c("page",function(i){C(t);let s=h();return S(s.handlePageEvent(i))}),r(),o(3,"form",46,0),c("ngSubmit",function(){C(t);let i=h();return S(i.onSearchChange())}),o(5,"input",47),ce("ngModelChange",function(i){C(t);let s=h();return pe(s.shopParams.search,i)||(s.shopParams.search=i),S(i)}),r(),o(6,"button",48)(7,"mat-icon"),m(8,"search"),r()()(),o(9,"div",49)(10,"button",50),c("click",function(){C(t);let i=h();return S(i.openFiltersDialog())}),o(11,"mat-icon"),m(12,"filter_list"),r(),m(13," Filters "),r(),o(14,"button",51)(15,"mat-icon"),m(16,"swap_vert"),r(),m(17," Sorts "),r(),o(18,"button",52),c("click",function(){C(t);let i=h();return S(i.openNewDialog())}),m(19," New Product "),r()()()(),o(20,"mat-menu",null,1)(22,"mat-selection-list",53),c("selectionChange",function(i){C(t);let s=h();return S(s.onSortChange(i))}),I(23,Nt,2,3,"mat-list-option",54,k),r()()}if(e&2){let t=de(21),n=h();l(2),d("length",n.products.count)("pageSize",n.shopParams.pageSize)("showFirstLastButtons",!0)("pageSizeOptions",n.pageSizeOptions)("pageIndex",n.shopParams.pageNumber-1),l(3),se("ngModel",n.shopParams.search),l(9),d("matMenuTriggerFor",t),l(8),d("multiple",!1),l(),A(n.sortOptions)}}function Rt(e,a){if(e&1){let t=q();o(0,"app-empty-state",55),c("action",function(){C(t);let i=h();return S(i.resetFilters())}),r()}}function Vt(e,a){e&1&&(o(0,"th",34),m(1,"No."),r())}function Lt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.id)}}function Ot(e,a){e&1&&(o(0,"th",34),m(1,"Name"),r())}function jt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.name)}}function Ut(e,a){e&1&&(o(0,"th",34),m(1,"Description"),r())}function zt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),v(" ",t.description," ")}}function qt(e,a){e&1&&(o(0,"th",34),m(1,"Price"),r())}function Bt(e,a){if(e&1&&(o(0,"td",35),m(1),$(2,"currency"),r()),e&2){let t=a.$implicit;l(),v(" ",ne(2,1,t.price)," ")}}function $t(e,a){e&1&&(o(0,"th",34),m(1,"Type"),r())}function Gt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.type)}}function Ht(e,a){e&1&&(o(0,"th",34),m(1,"Brand"),r())}function Wt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),x(t.brand)}}function Qt(e,a){e&1&&(o(0,"th",34),m(1,"Quantity"),r())}function Jt(e,a){if(e&1&&(o(0,"td",35),m(1),r()),e&2){let t=a.$implicit;l(),v(" ",t.quantityInStock," ")}}function Kt(e,a){e&1&&(o(0,"th",34),m(1,"Picture"),r())}function Xt(e,a){if(e&1&&(o(0,"td",35),f(1,"img",56),r()),e&2){let t=a.$implicit;l(),d("src",t.pictureUrl,N)("alt",t.name)}}function Yt(e,a){e&1&&(o(0,"th",34),m(1,"Actions"),r())}function Zt(e,a){if(e&1){let t=q();o(0,"td",35)(1,"div",36)(2,"button",37)(3,"mat-icon",38),m(4,"visibility"),r()(),o(5,"button",57),c("click",function(){let i=C(t).$implicit,s=h();return S(s.openEditDialog(i))}),o(6,"mat-icon",40),m(7,"edit"),r()(),o(8,"button",58),c("click",function(){let i=C(t).$implicit,s=h();return S(s.openDeleteDialog(i.id))}),o(9,"mat-icon",40),m(10,"delete"),r()()()()}if(e&2){let t=a.$implicit;l(2),ie("routerLink","/shop/",t.id,"")}}function ei(e,a){e&1&&f(0,"tr",41)}function ti(e,a){e&1&&f(0,"tr",42)}var vn=(()=>{class e{constructor(){this.displayedColumns=["id","buyerEmail","orderDate","total","status","action"],this.dataSource=new re([]),this.adminService=u(Xe),this.dialogService=u(Ze),this.orderParams=new te,this.totalItems=0,this.statusOptions=["All","PaymentReceived","PaymentMismatch","Refunded","Pending"],this.productDisplayedColumns=["id","name","description","price","type","brand","quantityInStock","pictureUrl","action"],this.productDataSource=new re([]),this.shopService=u(U),this.shopDialogService=u(B),this.deletedialog=u(B),this.cdr=u(_e),this.snack=u(R),this.sortOptions=[{name:"Alphabetical",value:"name"},{name:"Price: Low-High",value:"priceAsc"},{name:"Price: High-Low",value:"priceDesc"}],this.shopParams=new oe,this.pageSizeOptions=[5,10,15,20]}ngOnInit(){this.loadOrders(),this.initialiseShop()}loadOrders(){this.adminService.getOrders(this.orderParams).subscribe({next:t=>{t.data&&(this.dataSource.data=t.data,this.totalItems=t.count)}})}onPageChange(t){this.orderParams.pageNumber=t.pageIndex+1,this.orderParams.pageSize=t.pageSize,this.loadOrders()}onFilterSelect(t){this.orderParams.filter=t.value,this.orderParams.pageNumber=1,this.loadOrders()}openConfirmDialog(t){return ae(this,null,function*(){(yield this.dialogService.confirm("Confirm refund","Are you sure you want to issue this refund? This cannot be undone"))&&this.refundOrder(t)})}refundOrder(t){this.adminService.refundOrder(t).subscribe({next:n=>{this.dataSource.data=this.dataSource.data.map(i=>i.id===t?n:i)}})}initialiseShop(){this.shopService.getTypes(),this.shopService.getBrands(),this.getProducts()}resetFilters(){this.shopParams=new oe,this.getProducts()}getProducts(){this.shopService.getProducts(this.shopParams).subscribe({next:t=>{this.products=t,this.productDataSource.data=t.data},error:t=>console.error(t)})}onSearchChange(){this.shopParams.pageNumber=1,this.getProducts()}handlePageEvent(t){this.shopParams.pageNumber=t.pageIndex+1,this.shopParams.pageSize=t.pageSize,this.getProducts()}onSortChange(t){let n=t.options[0];n&&(this.shopParams.sort=n.value,this.shopParams.pageNumber=1,this.getProducts())}openFiltersDialog(){this.shopDialogService.open(Me,{minWidth:"500px",data:{selectedBrands:this.shopParams.brands,selectedTypes:this.shopParams.types}}).afterClosed().subscribe({next:n=>{n&&(this.shopParams.brands=n.selectedBrands,this.shopParams.types=n.selectedTypes,this.shopParams.pageNumber=1,this.getProducts())}})}openEditDialog(t){this.shopDialogService.open(it,{width:"500px",data:{product:t}}).afterClosed().subscribe(i=>{i&&this.initialiseShop()})}openNewDialog(){this.shopDialogService.open(nt,{width:"500px",data:{product:null}}).afterClosed().subscribe(n=>{n&&this.initialiseShop()})}openDeleteDialog(t){this.deletedialog.open(ii,{width:"400px",data:{productId:t}}).afterClosed().subscribe(i=>{i&&this.deleteProduct(t)})}deleteProduct(t){this.shopService.deleteProduct(t).subscribe({next:n=>{this.snack.success(n),this.initialiseShop()},error:n=>console.error(n)})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=y({type:e,selectors:[["app-admin"]],standalone:!0,features:[E],decls:71,vars:11,consts:[["searchForm","ngForm"],["sortMenu","matMenu"],[1,"min-h-screen"],[1,"bg-white"],["label","Orders"],[1,"flex","justify-between","items-center","mt-2","max-w-screen-2xl","mx-auto"],[1,"text-2xl","font-semibold"],["appearance","outline",1,"mt-2"],[3,"selectionChange"],[3,"value"],[1,"p-0"],[1,"mat-elevation-z8"],["mat-table","",1,"bg-white",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","buyerEmail"],["matColumnDef","orderDate"],["matColumnDef","total"],["matColumnDef","status"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",1,"bg-white",3,"page","pageSizeOptions","length","pageSize"],["label","Product"],["message","No products match this filter","icon","filter_alt_off","actionText","Reset filters"],[1,"mat-elevation-z8","mt-4"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","price"],["matColumnDef","type"],["matColumnDef","brand"],["matColumnDef","quantityInStock"],["matColumnDef","pictureUrl"],["mat-header-cell",""],["mat-cell",""],[1,"flex","gap-2"],["matTooltip","View","mat-icon-button","",3,"routerLink"],["color","accent"],["matTooltip","Refund","mat-icon-button","",3,"click","disabled"],["color","warn"],["mat-header-row",""],["mat-row",""],[1,"flex","flex-col","gap-3"],[1,"flex","justify-between"],["aria-label","Select page",1,"bg-white",3,"page","length","pageSize","showFirstLastButtons","pageSizeOptions","pageIndex"],[1,"relative","flex","items-center","w-full","max-w-md","mx-4",3,"ngSubmit"],["type","search","placeholder","Search","name","search",1,"block","w-full","p-4","text-sm","text-gray-900","border","border-gray-300","rounded-lg",3,"ngModelChange","ngModel"],["mat-icon-button","","type","submit",1,"absolute","inset-y-0","right-8","top-2","flex","items-center","pl-3"],[1,"flex","gap-3"],["mat-stroked-button","",1,"match-input-height",3,"click"],["mat-stroked-button","",1,"match-input-height",3,"matMenuTriggerFor"],["mat-flat-button","","type","button",1,"match-input-height","py-2","bg-primary","text-white","rounded-md","shadow","hover:bg-primary-dark","transition",3,"click"],[3,"selectionChange","multiple"],[3,"value","selected"],["message","No products match this filter","icon","filter_alt_off","actionText","Reset filters",3,"action"],[1,"my-2","h-16","w-16","object-cover","rounded-md",3,"src","alt"],["matTooltip","Edit","mat-icon-button","",3,"click"],["matTooltip","Delete","mat-icon-button","",3,"click"]],template:function(n,i){n&1&&(o(0,"div",2)(1,"mat-tab-group",3)(2,"mat-tab",4)(3,"div",5)(4,"h2",6),m(5,"Customer orders"),r(),o(6,"mat-form-field",7)(7,"mat-label"),m(8,"Filter by status"),r(),o(9,"mat-select",8),c("selectionChange",function(M){return i.onFilterSelect(M)}),I(10,bt,2,2,"mat-option",9,k),r()()(),o(12,"div",10)(13,"div",11)(14,"table",12),g(15,13),p(16,xt,2,0,"th",14)(17,Ct,2,1,"td",15),b(),g(18,16),p(19,St,2,0,"th",14)(20,vt,2,1,"td",15),b(),g(21,17),p(22,yt,2,0,"th",14)(23,wt,3,4,"td",15),b(),g(24,18),p(25,Et,2,0,"th",14)(26,Pt,3,3,"td",15),b(),g(27,19),p(28,Tt,2,0,"th",14)(29,Dt,2,1,"td",15),b(),g(30,20),p(31,Mt,2,0,"th",14)(32,kt,8,3,"td",15),b(),p(33,It,1,0,"tr",21)(34,At,1,0,"tr",22),r(),o(35,"mat-paginator",23),c("page",function(M){return i.onPageChange(M)}),r()()()(),o(36,"mat-tab",24),f(37,"br"),p(38,Ft,25,8)(39,Rt,1,0,"app-empty-state",25),o(40,"div",26)(41,"table",12),g(42,13),p(43,Vt,2,0,"th",14)(44,Lt,2,1,"td",15),b(),g(45,27),p(46,Ot,2,0,"th",14)(47,jt,2,1,"td",15),b(),g(48,28),p(49,Ut,2,0,"th",14)(50,zt,2,1,"td",15),b(),g(51,29),p(52,qt,2,0,"th",14)(53,Bt,3,3,"td",15),b(),g(54,30),p(55,$t,2,0,"th",14)(56,Gt,2,1,"td",15),b(),g(57,31),p(58,Ht,2,0,"th",14)(59,Wt,2,1,"td",15),b(),g(60,32),p(61,Qt,2,0,"th",14)(62,Jt,2,1,"td",15),b(),g(63,33),p(64,Kt,2,0,"th",14)(65,Xt,2,2,"td",15),b(),g(66,20),p(67,Yt,2,0,"th",14)(68,Zt,11,2,"td",15),b(),p(69,ei,1,0,"tr",21)(70,ti,1,0,"tr",22),r()()()()()),n&2&&(l(10),A(i.statusOptions),l(4),d("dataSource",i.dataSource),l(19),d("matHeaderRowDef",i.displayedColumns),l(),d("matRowDefColumns",i.displayedColumns),l(),d("pageSizeOptions",ue(10,gt))("length",i.totalItems)("pageSize",i.orderParams.pageSize),l(3),F(i.products&&i.products.count>0?38:39),l(3),d("dataSource",i.productDataSource),l(28),d("matHeaderRowDef",i.productDisplayedColumns),l(),d("matRowDefColumns",i.productDisplayedColumns))},dependencies:[We,Le,je,Be,Ue,Oe,$e,ze,qe,Ge,He,Ve,Re,P,Ce,z,Pe,Ee,Ae,xe,he,ge,Fe,Ne,Ke,Qe,Je,be,j,O,ve,V,L,we,ye,De,Ie,ke,Te,Se]})}}return e})(),ii=(()=>{class e{constructor(t,n){this.dialogRef=t,this.data=n}static{this.\u0275fac=function(n){return new(n||e)(w(T),w(D))}}static{this.\u0275cmp=y({type:e,selectors:[["app-delete-dialog-content"]],standalone:!0,features:[E],decls:9,vars:0,consts:[[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-50"],[1,"max-w-lg","w-full","mx-auto","bg-white","p-8","rounded-md","shadow-lg"],[1,"text-center","mb-6","text-lg","font-bold"],[1,"text-center"],["mat-button","",1,"py-2","px-4",3,"click"],["mat-button","","color","warn",1,"py-2","px-4",3,"click"]],template:function(n,i){n&1&&(o(0,"div",0)(1,"div",1)(2,"p",2),m(3," Are you sure you want to delete this product? This cannot be undone! "),r(),o(4,"div",3)(5,"button",4),c("click",function(){return i.dialogRef.close(!1)}),m(6," Cancel "),r(),o(7,"button",5),c("click",function(){return i.dialogRef.close(!0)}),m(8," Delete "),r()()()())},dependencies:[P],encapsulation:2})}}return e})();export{vn as AdminComponent,ii as DeleteDialogContent};
